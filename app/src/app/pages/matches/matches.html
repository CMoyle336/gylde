<div class="matches-page">
  <!-- Tabs -->
  <div class="matches-tabs">
    <!-- Free Tabs -->
    <button
      type="button"
      class="tab-btn"
      [class.active]="activeTab() === 'my-matches'"
      (click)="setTab('my-matches')">
      <span class="tab-icon-wrapper">
        <span class="material-icons-outlined">favorite</span>
        @if (matchesCount() > 0) {
          <span class="tab-badge">{{ matchesCount() > 99 ? '99+' : matchesCount() }}</span>
        }
      </span>
      <span class="tab-label">My Matches</span>
    </button>
    <button
      type="button"
      class="tab-btn"
      [class.active]="activeTab() === 'my-favorites'"
      (click)="setTab('my-favorites')">
      <span class="material-icons-outlined">star</span>
      <span class="tab-label">My Favorites</span>
    </button>
    <button
      type="button"
      class="tab-btn"
      [class.active]="activeTab() === 'my-views'"
      (click)="setTab('my-views')">
      <span class="material-icons-outlined">history</span>
      <span class="tab-label">Recently Viewed</span>
    </button>

    <!-- Premium Tabs -->
    <button
      type="button"
      class="tab-btn"
      [class.active]="activeTab() === 'favorited-me'"
      [class.premium-locked]="!isPremium()"
      (click)="setTab('favorited-me')">
      <span class="tab-icon-wrapper">
        @if (!isPremium()) {
          <span class="material-icons-outlined premium-icon">star</span>
        } @else {
          <span class="material-icons-outlined">volunteer_activism</span>
          @if (favoritedMeCount() > 0) {
            <span class="tab-badge">{{ favoritedMeCount() > 99 ? '99+' : favoritedMeCount() }}</span>
          }
        }
      </span>
      <span class="tab-label">Favorited Me</span>
      @if (!isPremium()) {
        <span class="premium-badge">Premium</span>
      }
    </button>
    <button
      type="button"
      class="tab-btn"
      [class.active]="activeTab() === 'viewed-me'"
      [class.premium-locked]="!isPremium()"
      (click)="setTab('viewed-me')">
      <span class="tab-icon-wrapper">
        @if (!isPremium()) {
          <span class="material-icons-outlined premium-icon">star</span>
        } @else {
          <span class="material-icons-outlined">visibility</span>
          @if (viewedMeCount() > 0) {
            <span class="tab-badge">{{ viewedMeCount() > 99 ? '99+' : viewedMeCount() }}</span>
          }
        }
      </span>
      <span class="tab-label">Viewed Me</span>
      @if (!isPremium()) {
        <span class="premium-badge">Premium</span>
      }
    </button>
  </div>

  <!-- Content -->
  <div class="matches-content">
    @if (loading() || !initialized()) {
      <!-- Loading Skeleton -->
      <div class="profile-grid">
        @for (i of skeletonCards; track i) {
          <app-profile-card-skeleton />
        }
      </div>
    } @else if (isEmpty()) {
      <!-- Empty State (only shown after initialization) -->
      <div class="empty-state">
        <span class="material-icons-outlined empty-icon">{{ getEmptyIcon() }}</span>
        <p class="empty-message">{{ getEmptyMessage() }}</p>
        @if (activeTab() === 'my-favorites' || activeTab() === 'my-views') {
          <button mat-flat-button color="primary" routerLink="/discover">
            <mat-icon>explore</mat-icon>
            Explore Profiles
          </button>
        }
      </div>
    } @else {
      <!-- Profile Grid using shared ProfileCardComponent -->
      <div class="profile-grid">
        @for (profile of profiles(); track profile.uid) {
          <app-profile-card
            [profile]="profile"
            [isFavorited]="isFavorited(profile.uid)"
            [showInteractionTime]="true"
            (messageClick)="onMessage($event)"
            (viewClick)="onViewProfile($event)"
            (favoriteClick)="onFavorite($event)"
          />
        }
      </div>
    }
  </div>
</div>
