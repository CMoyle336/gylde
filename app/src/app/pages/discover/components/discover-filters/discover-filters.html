<div class="filters-panel">
  <!-- Primary Filters Row -->
  <div class="primary-filters-row">
    <!-- Distance -->
    <div class="filter-group compact">
      <label class="filter-label">Distance</label>
      <mat-form-field appearance="outline" class="full-width">
        <mat-select [value]="filters().maxDistance" (selectionChange)="updateFilter('maxDistance', $event.value)">
          @for (option of distanceOptions(); track option.value) {
            <mat-option [value]="option.value">{{ option.label }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
    </div>

    <!-- Toggles -->
    <div class="toggles-row">
      <div class="toggle-item compact">
        <mat-slide-toggle
          [checked]="filters().verifiedOnly"
          (change)="updateFilter('verifiedOnly', $event.checked)">
          Verified only
        </mat-slide-toggle>
      </div>

      <div class="toggle-item compact">
        <mat-slide-toggle
          [checked]="filters().onlineNow"
          (change)="updateFilter('onlineNow', $event.checked)">
          Online now
        </mat-slide-toggle>
      </div>

      <div class="toggle-item compact">
        <mat-slide-toggle
          [checked]="filters().activeRecently"
          (change)="updateFilter('activeRecently', $event.checked)">
          Active in 24h
        </mat-slide-toggle>
      </div>
    </div>
  </div>

  <!-- Looking For Section -->
  <div class="filter-section">
    <label class="filter-label">Looking For</label>
    <div class="chip-grid">
      <!-- Relationship Goals -->
      <div class="chip-group-row">
        @for (option of relationshipGoals(); track option.value) {
          <button 
            type="button"
            class="filter-chip"
            [class.selected]="isFilterSelected('connectionTypes', option.value)"
            (click)="toggleArrayFilter('connectionTypes', option.value)">
            {{ option.label }}
          </button>
        }
      </div>
      <!-- Relationship Style -->
      <div class="chip-group-row">
        @for (option of relationshipStyle(); track option.value) {
          <button 
            type="button"
            class="filter-chip"
            [class.selected]="isFilterSelected('connectionTypes', option.value)"
            (click)="toggleArrayFilter('connectionTypes', option.value)">
            {{ option.label }}
          </button>
        }
      </div>
      <!-- Lifestyle -->
      <div class="chip-group-row">
        @for (option of lifestylePreferences(); track option.value) {
          <button 
            type="button"
            class="filter-chip"
            [class.selected]="isFilterSelected('connectionTypes', option.value)"
            (click)="toggleArrayFilter('connectionTypes', option.value)">
            {{ option.label }}
          </button>
        }
      </div>
    </div>
  </div>

  <!-- Show More Filters Toggle -->
  <button type="button" class="show-more-btn" (click)="toggleAdvancedFilters()">
    <mat-icon>{{ showAdvancedFilters() ? 'expand_less' : 'expand_more' }}</mat-icon>
    {{ showAdvancedFilters() ? 'Less filters' : 'More filters' }}
  </button>

  <!-- Advanced Filters -->
  @if (showAdvancedFilters()) {
    <div class="filters-row advanced-filters">
      <!-- Support Orientation -->
      <div class="filter-group">
        <label class="filter-label">Support Style</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().supportOrientation" (selectionChange)="updateFilter('supportOrientation', $event.value)">
            @for (option of supportOrientationOptions(); track option.value) {
              <mat-option [value]="option.value">{{ option.label }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Height -->
      <div class="filter-group">
        <label class="filter-label">Height</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().height" (selectionChange)="updateFilter('height', $event.value)">
            @for (option of heightOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Income -->
      <div class="filter-group">
        <label class="filter-label">Income</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().income" (selectionChange)="updateFilter('income', $event.value)">
            @for (option of incomeOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Ethnicity -->
      <div class="filter-group">
        <label class="filter-label">Ethnicity</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().ethnicity" (selectionChange)="updateFilter('ethnicity', $event.value)">
            @for (option of ethnicityOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Relationship Status -->
      <div class="filter-group">
        <label class="filter-label">Relationship Status</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().relationshipStatus" (selectionChange)="updateFilter('relationshipStatus', $event.value)">
            @for (option of relationshipStatusOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Children -->
      <div class="filter-group">
        <label class="filter-label">Children</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().children" (selectionChange)="updateFilter('children', $event.value)">
            @for (option of childrenOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Smoker -->
      <div class="filter-group">
        <label class="filter-label">Smoking</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().smoker" (selectionChange)="updateFilter('smoker', $event.value)">
            @for (option of smokerOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Drinker -->
      <div class="filter-group">
        <label class="filter-label">Drinking</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().drinker" (selectionChange)="updateFilter('drinker', $event.value)">
            @for (option of drinkerOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Education -->
      <div class="filter-group">
        <label class="filter-label">Education</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().education" (selectionChange)="updateFilter('education', $event.value)">
            @for (option of educationOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>
    </div>
  }

  <!-- Filter Actions -->
  <div class="filter-actions">
    <button mat-button (click)="onReset()">
      <mat-icon>refresh</mat-icon>
      Reset All
    </button>
    <button mat-flat-button color="primary" (click)="onApply()">
      <mat-icon>search</mat-icon>
      Apply Filters
    </button>
  </div>
</div>
