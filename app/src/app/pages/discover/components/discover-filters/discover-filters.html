<div class="filters-panel">
  <!-- Member Status Filter - Core Feature -->
  <div class="reputation-filter-section">
    <div class="reputation-filter-header">
      <label class="filter-label">{{ 'DISCOVER.FILTER_PANEL.MEMBER_STATUS_LABEL' | translate }}</label>
      <span class="filter-hint">{{ 'DISCOVER.FILTER_PANEL.MEMBER_STATUS_HINT' | translate }}</span>
    </div>
    <div class="reputation-tier-selector">
      @for (tier of tierVisualOptions; track tier.value) {
        <button
          type="button"
          class="tier-option"
          [class.selected]="isReputationTierSelected(tier.value)"
          [style.--tier-color]="tier.color"
          [matTooltip]="tier.descriptionKey | translate"
          matTooltipPosition="above"
          (click)="selectReputationTier(tier.value)">
          <mat-icon class="tier-icon">{{ tier.icon }}</mat-icon>
          <span class="tier-label">{{ tier.labelKey | translate }}</span>
          @if (isReputationTierSelected(tier.value)) {
            <mat-icon class="tier-check">check_circle</mat-icon>
          }
        </button>
      }
    </div>
  </div>

  <!-- Primary Filters Row -->
  <div class="primary-filters-row">
    <!-- Quick Filter Toggles -->
    <div class="quick-filters-section">
      <div class="filter-header">
        <mat-icon class="filter-header-icon">filter_alt</mat-icon>
        <label class="filter-label">{{ 'DISCOVER.FILTER_PANEL.QUICK_FILTERS_LABEL' | translate }}</label>
      </div>
      <div class="quick-filters-grid">
        <button
          type="button"
          class="quick-filter-card"
          [class.active]="filters().verifiedOnly"
          (click)="updateFilter('verifiedOnly', !filters().verifiedOnly)">
          <div class="quick-filter-icon-wrapper verified">
            <mat-icon>verified</mat-icon>
          </div>
          <span class="quick-filter-label">{{ 'DISCOVER.FILTER_PANEL.QUICK_FILTERS.VERIFIED_ONLY' | translate }}</span>
          <div class="quick-filter-indicator">
            <div class="indicator-dot"></div>
          </div>
        </button>

        <button
          type="button"
          class="quick-filter-card"
          [class.active]="filters().onlineNow"
          (click)="updateFilter('onlineNow', !filters().onlineNow)">
          <div class="quick-filter-icon-wrapper online">
            <mat-icon>circle</mat-icon>
          </div>
          <span class="quick-filter-label">{{ 'DISCOVER.FILTER_PANEL.QUICK_FILTERS.ONLINE_NOW' | translate }}</span>
          <div class="quick-filter-indicator">
            <div class="indicator-dot"></div>
          </div>
        </button>

        <button
          type="button"
          class="quick-filter-card"
          [class.active]="filters().activeRecently"
          (click)="updateFilter('activeRecently', !filters().activeRecently)">
          <div class="quick-filter-icon-wrapper recent">
            <mat-icon>schedule</mat-icon>
          </div>
          <span class="quick-filter-label">{{ 'DISCOVER.FILTER_PANEL.QUICK_FILTERS.ACTIVE_24H' | translate }}</span>
          <div class="quick-filter-indicator">
            <div class="indicator-dot"></div>
          </div>
        </button>
      </div>
    </div>

    <!-- Distance Selector -->
    <div class="distance-filter-section">
      <div class="filter-header">
        <mat-icon class="filter-header-icon">location_on</mat-icon>
        <label class="filter-label">{{ 'DISCOVER.FILTER_PANEL.DISTANCE_LABEL' | translate }}</label>
      </div>
      <div class="distance-selector">
        @for (option of distanceOptions(); track option.value) {
          <button
            type="button"
            class="distance-option"
            [class.selected]="filters().maxDistance === option.value"
            (click)="updateFilter('maxDistance', option.value)">
            <span class="distance-value">{{ option.labelKey | translate: option.labelParams }}</span>
          </button>
        }
      </div>
    </div>
  </div>

  <!-- Looking For Section -->
  <div class="filter-section">
    <label class="filter-label">{{ 'DISCOVER.FILTER_PANEL.LOOKING_FOR_LABEL' | translate }}</label>
    <div class="chip-grid">
      <!-- Relationship Goals -->
      <div class="chip-group-row">
        @for (option of relationshipGoals(); track option.value) {
          <button 
            type="button"
            class="filter-chip"
            [class.selected]="isFilterSelected('connectionTypes', option.value)"
            (click)="toggleArrayFilter('connectionTypes', option.value)">
            {{ ('ONBOARDING.STEP_3.' + option.labelKey) | translate }}
          </button>
        }
      </div>
      <!-- Relationship Style -->
      <div class="chip-group-row">
        @for (option of relationshipStyle(); track option.value) {
          <button 
            type="button"
            class="filter-chip"
            [class.selected]="isFilterSelected('connectionTypes', option.value)"
            (click)="toggleArrayFilter('connectionTypes', option.value)">
            {{ ('ONBOARDING.STEP_3.' + option.labelKey) | translate }}
          </button>
        }
      </div>
      <!-- Lifestyle -->
      <div class="chip-group-row">
        @for (option of lifestylePreferences(); track option.value) {
          <button 
            type="button"
            class="filter-chip"
            [class.selected]="isFilterSelected('connectionTypes', option.value)"
            (click)="toggleArrayFilter('connectionTypes', option.value)">
            {{ ('ONBOARDING.STEP_3.' + option.labelKey) | translate }}
          </button>
        }
      </div>
    </div>
  </div>

  <!-- Show More Filters Toggle -->
  <button type="button" class="show-more-btn" [class.premium-locked]="!isPremium()" (click)="toggleAdvancedFilters()">
    @if (!isPremium()) {
      <mat-icon class="premium-icon">star</mat-icon>
    } @else {
      <mat-icon>{{ showAdvancedFilters() ? 'expand_less' : 'expand_more' }}</mat-icon>
    }
    {{ (showAdvancedFilters() ? 'DISCOVER.FILTER_PANEL.LESS_FILTERS' : 'DISCOVER.FILTER_PANEL.MORE_FILTERS') | translate }}
    @if (!isPremium()) {
      <span class="premium-badge">{{ 'DISCOVER.FILTER_PANEL.PREMIUM_BADGE' | translate }}</span>
    }
  </button>

  <!-- Advanced Filters -->
  @if (showAdvancedFilters()) {
    <div class="filters-row advanced-filters">
      <!-- Support Orientation -->
      <div class="filter-group">
        <label class="filter-label">{{ 'DISCOVER.FILTER_PANEL.ADVANCED.SUPPORT_STYLE' | translate }}</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().supportOrientation" (selectionChange)="updateFilter('supportOrientation', $event.value)">
            @for (option of supportOrientationOptions(); track option.value) {
              <mat-option [value]="option.value">{{ ('DISCOVER.FILTER_PANEL.SUPPORT_ORIENTATION.' + option.value.toUpperCase()) | translate }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Height -->
      <div class="filter-group">
        <label class="filter-label">{{ 'DISCOVER.FILTER_PANEL.ADVANCED.HEIGHT' | translate }}</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().height" (selectionChange)="updateFilter('height', $event.value)">
            @for (option of heightOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Income -->
      <div class="filter-group">
        <label class="filter-label">{{ 'DISCOVER.FILTER_PANEL.ADVANCED.INCOME' | translate }}</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().income" (selectionChange)="updateFilter('income', $event.value)">
            @for (option of incomeOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Ethnicity -->
      <div class="filter-group">
        <label class="filter-label">{{ 'DISCOVER.FILTER_PANEL.ADVANCED.ETHNICITY' | translate }}</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().ethnicity" (selectionChange)="updateFilter('ethnicity', $event.value)">
            @for (option of ethnicityOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Relationship Status -->
      <div class="filter-group">
        <label class="filter-label">{{ 'DISCOVER.FILTER_PANEL.ADVANCED.RELATIONSHIP_STATUS' | translate }}</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().relationshipStatus" (selectionChange)="updateFilter('relationshipStatus', $event.value)">
            @for (option of relationshipStatusOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Children -->
      <div class="filter-group">
        <label class="filter-label">{{ 'DISCOVER.FILTER_PANEL.ADVANCED.CHILDREN' | translate }}</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().children" (selectionChange)="updateFilter('children', $event.value)">
            @for (option of childrenOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Smoker -->
      <div class="filter-group">
        <label class="filter-label">{{ 'DISCOVER.FILTER_PANEL.ADVANCED.SMOKING' | translate }}</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().smoker" (selectionChange)="updateFilter('smoker', $event.value)">
            @for (option of smokerOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Drinker -->
      <div class="filter-group">
        <label class="filter-label">{{ 'DISCOVER.FILTER_PANEL.ADVANCED.DRINKING' | translate }}</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().drinker" (selectionChange)="updateFilter('drinker', $event.value)">
            @for (option of drinkerOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Education -->
      <div class="filter-group">
        <label class="filter-label">{{ 'DISCOVER.FILTER_PANEL.ADVANCED.EDUCATION' | translate }}</label>
        <mat-form-field appearance="outline" class="full-width">
          <mat-select multiple [value]="filters().education" (selectionChange)="updateFilter('education', $event.value)">
            @for (option of educationOptions(); track option) {
              <mat-option [value]="option">{{ option }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>
    </div>
  }

  <!-- Filter Actions -->
  <div class="filter-actions">
    <button mat-button (click)="onReset()">
      <mat-icon>refresh</mat-icon>
      {{ 'DISCOVER.FILTER_PANEL.ACTIONS.RESET_ALL' | translate }}
    </button>
    <button mat-flat-button color="primary" (click)="onApply()">
      <mat-icon>search</mat-icon>
      {{ 'DISCOVER.FILTER_PANEL.ACTIONS.APPLY_FILTERS' | translate }}
    </button>
  </div>
</div>
