<div class="virtual-phone-card">
  @if (isElite && virtualPhone) {
    <!-- Elite user with virtual number -->
    <div class="vp-number-display">
      <div class="vp-info">
        <span class="material-icons-outlined vp-icon">phone_android</span>
        <div class="vp-details">
          <span class="vp-label">Your Private Number</span>
          <span class="vp-number">{{ formatPhoneNumber(virtualPhone.number) }}</span>
        </div>
      </div>
      <div class="vp-actions">
        <button 
          type="button"
          class="vp-action-btn"
          (click)="onCopyNumber()"
          [title]="copiedNumber() ? 'Copied!' : 'Copy number'">
          <span class="material-icons-outlined">{{ copiedNumber() ? 'check' : 'content_copy' }}</span>
        </button>
        <button 
          type="button"
          class="vp-action-btn"
          (click)="onOpenSettings()"
          title="Settings">
          <span class="material-icons-outlined">settings</span>
        </button>
      </div>
    </div>
  } @else if (isElite && loading) {
    <!-- Elite user, loading -->
    <div class="vp-loading">
      <div class="loading-spinner small"></div>
      <span>Loading...</span>
    </div>
  } @else if (isElite && !hasVerifiedPhone) {
    <!-- Elite user, need to verify phone first -->
    <div class="vp-promo vp-needs-phone">
      <div class="vp-promo-text">
        <span class="material-icons-outlined">phone_locked</span>
        <span>Verify your phone number first to get a private number for sharing with connections</span>
      </div>
      <a routerLink="/settings" class="vp-verify-btn">
        <span class="material-icons-outlined">verified_user</span>
        <span>Verify Phone in Settings</span>
      </a>
    </div>
  } @else if (isElite) {
    <!-- Elite user, can get virtual number -->
    <div class="vp-promo">
      <div class="vp-promo-text">
        <span class="material-icons-outlined">shield</span>
        <span>Share a number with connections without revealing your real one</span>
      </div>
      <button type="button" class="vp-get-number-btn" (click)="onProvision()" [disabled]="provisioning">
        @if (provisioning) {
          <div class="loading-spinner small"></div>
          <span>Setting up...</span>
        } @else {
          <span class="material-icons-outlined">add_call</span>
          <span>Get Private Number</span>
        }
      </button>
    </div>
    @if (error) {
      <p class="vp-error">{{ error }}</p>
    }
  } @else {
    <!-- Non-Elite user, show upgrade prompt -->
    <div class="vp-promo">
      <div class="vp-promo-text">
        <span class="material-icons-outlined">shield</span>
        <span>Share a number with connections without revealing your real one</span>
      </div>
      <button type="button" class="vp-get-number-btn vp-upgrade-btn" (click)="onShowUpgrade()">
        <span class="material-icons-outlined">add_call</span>
        <span>Get Private Number</span>
      </button>
    </div>
  }
</div>
